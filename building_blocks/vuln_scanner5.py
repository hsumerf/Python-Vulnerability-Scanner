#!/usr/bin/env python

import scanner5
links_to_ignore = ["http://192.168.184.133/dvwa/logout.php"]
import time
from bs4 import BeautifulSoup

target_url = "http://192.168.184.128/dvwa/"
data_dict = {"username":"admin","password":"password","Login":"submit"}
vuln_scanner = scanner5.Scanner(target_url,links_to_ignore)
response = vuln_scanner.session.post("http://192.168.184.133/dvwa/login.php", data=data_dict)

# vuln_scanner.crawl()
forms = vuln_scanner.extract_forms("http://192.168.184.133/dvwa/vulnerabilities/xss_r/")
print(forms)
# response = vuln_scanner.submit_form(forms[0],"testtest","http://192.168.184.128/dvwa/vulnerabilities/xss_r/")
response = vuln_scanner.test_xss_in_form(forms[0],"http://192.168.184.133/dvwa/vulnerabilities/xss_r/")
print(response)

# print(type(response.content.decode()))
# response =str(response.content.decode())
# str1 = "<script>alert('Hi umer')</script>"
# import html
# html.unescape(str1)
# print(html.unescape(str1))
# if "<script>alert('Hi umer')</script>" in response:
#     print("True")
# else:
#     print("false")
# print(type(response))
# soup = BeautifulSoup(response, 'html.parser')
# # print(soup.prettify())
# print(type(soup))
# # vuln_scanner.run_scanner()
